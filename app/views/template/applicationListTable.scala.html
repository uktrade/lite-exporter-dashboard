@import models.enums.{ApplicationListTab, ApplicationProgress, ApplicationSortType}
@import models.view.ApplicationListView
@import template._
@(applicationListView: ApplicationListView)

@if(!applicationListView.getPage.getItems.isEmpty) {
  <div class="scrollable-table">
    <table class="table-font-xsmall table-align-top">
      <thead>
        <tr>
          <th nowrap>
            <a href="@applicationListView.getApplicationRoute.nextSort(ApplicationSortType.DATE).toString">
            @if(applicationListView.getApplicationProgress == ApplicationProgress.DRAFT) {
              Date created
            } else {
              Date submitted
            }
            </a>
            @if(applicationListView.getApplicationSortType == ApplicationSortType.DATE) {
              @sortArrow(applicationListView.getSortDirection)
            } else {
              @sortArrow(null)
            }
          </th>
          <th>
            References
          </th>
          <th nowrap>
            <a href="@applicationListView.getApplicationRoute.nextSort(ApplicationSortType.STATUS).toString">
              Application status
            </a>
            @if(applicationListView.getApplicationSortType == ApplicationSortType.STATUS) {
              @sortArrow(applicationListView.getSortDirection)
            } else {
              @sortArrow(null)
            }
          </th>
          <th>
            Destination
          </th>
          @if(applicationListView.getApplicationListTab == ApplicationListTab.COMPANY) {
            <th nowrap>
              <a href="@applicationListView.getApplicationRoute.nextSort(ApplicationSortType.CREATED_BY).toString">
                Created by
              </a>
              @if(applicationListView.getApplicationSortType == ApplicationSortType.CREATED_BY) {
                @sortArrow(applicationListView.getSortDirection)
              } else {
                @sortArrow(null)
              }
            </th>
          }
        </tr>
      </thead>
      <tbody>
      @for(applicationItemView <- applicationListView.getPage.getItems) {
        <tr>
          <th scope="row">
          @if(applicationListView.getApplicationProgress == ApplicationProgress.DRAFT || applicationItemView.getApplicationProgress != ApplicationProgress.DRAFT) {
            @applicationItemView.getDate
          }
          </th>
          <td>
          @if(applicationItemView.getCaseReference != null) {
            <a href="@routes.StatusTabController.showStatusTab(applicationItemView.getAppId)" class="bold">
            @applicationItemView.getCaseReference
            </a>
            <br>
            @applicationItemView.getApplicantReference
          } else {
            <a href="#" class="bold">
            @applicationItemView.getApplicantReference
            </a>
          }
          </td>
          <td>
            <p>
              @applicationItemView.getApplicationStatus
            <br>
            @applicationItemView.getApplicationStatusDate
            </p>
            @if(applicationItemView.getOpenRfiId != null) {
              @rfiLabel(routes.RfiTabController.showRfiTab(applicationItemView.getAppId).withFragment(applicationItemView.getOpenRfiId).toString)
            }
          </td>
          <td>
          @applicationItemView.getDestination
          </td>
          @if(applicationListView.getApplicationListTab == ApplicationListTab.COMPANY) {
            <td>
            @applicationItemView.getCreatedByFirstName @applicationItemView.getCreatedByLastName
            </td>
          }
        </tr>
      }
      </tbody>
    </table>
  </div>
}
